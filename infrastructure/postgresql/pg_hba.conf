# PostgreSQL Host-Based Authentication Configuration (Production)
# TYPE  DATABASE        USER            ADDRESS                 METHOD

# Local connections
local   all             postgres                                peer
local   all             all                                     scram-sha-256

# IPv4 local connections
host    all             postgres        127.0.0.1/32           scram-sha-256

# Docker network connections (restrict to application containers)
host    all             all             172.21.0.0/24          scram-sha-256

# Require SSL for all remote connections
hostssl all             all             0.0.0.0/0              scram-sha-256

# Deny all other connections
host    all             all             0.0.0.0/0              reject

# Replication connections (if needed)
# hostssl replication     replicator      172.21.0.0/24          scram-sha-256