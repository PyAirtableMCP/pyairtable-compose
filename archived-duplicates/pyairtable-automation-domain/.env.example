# PyAirtable Automation Domain Service Configuration
# Copy this file to .env and update the values for your environment

# =============================================================================
# CORE CONFIGURATION
# =============================================================================

# Environment: development, staging, production
ENV=development

# Server configuration
HOST=0.0.0.0
PORT=8090
WORKERS=1
RELOAD=true
DEBUG=false

# Service metadata
SERVICE_NAME=PyAirtable Automation Domain
SERVICE_VERSION=1.0.0
SERVICE_DESCRIPTION=Consolidated automation domain service for workflow, notification, and webhook management

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL connection
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/pyairtable_automation
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20
DATABASE_ECHO=false

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis connection
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=
REDIS_MAX_CONNECTIONS=20
REDIS_RETRY_ON_TIMEOUT=true

# =============================================================================
# CELERY CONFIGURATION
# =============================================================================

# Celery broker and result backend
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2

# Task configuration
CELERY_TASK_SERIALIZER=json
CELERY_ACCEPT_CONTENT=json
CELERY_RESULT_SERIALIZER=json
CELERY_TIMEZONE=UTC
CELERY_ENABLE_UTC=true
CELERY_TASK_TRACK_STARTED=true
CELERY_TASK_TIME_LIMIT=1800
CELERY_TASK_SOFT_TIME_LIMIT=1500
CELERY_WORKER_PREFETCH_MULTIPLIER=1

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# API Keys (REQUIRED - Generate secure random strings)
INTERNAL_API_KEY=your-internal-api-key-here
JWT_SECRET_KEY=your-jwt-secret-key-here
WEBHOOK_SECRET_KEY=your-webhook-secret-key-here

# JWT Configuration
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=30

# =============================================================================
# NOTIFICATION CONFIGURATION
# =============================================================================

# SMTP Configuration
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_USE_TLS=false
SMTP_USE_SSL=false

# Default sender
NOTIFICATION_FROM_EMAIL=noreply@pyairtable.com
NOTIFICATION_FROM_NAME=PyAirtable

# Rate limiting
EMAIL_RATE_LIMIT=100

# =============================================================================
# WEBHOOK CONFIGURATION
# =============================================================================

# Webhook delivery settings
WEBHOOK_MAX_RETRIES=3
WEBHOOK_RETRY_DELAY=60
WEBHOOK_TIMEOUT=30
WEBHOOK_VERIFY_SSL=true

# Webhook signing
WEBHOOK_SIGNATURE_HEADER=X-Webhook-Signature

# =============================================================================
# OBSERVABILITY CONFIGURATION
# =============================================================================

# Logging
LOG_LEVEL=INFO
STRUCTURED_LOGGING=true

# Metrics
ENABLE_METRICS=true
METRICS_PORT=9090

# Tracing
ENABLE_TRACING=true
JAEGER_ENDPOINT=
TRACE_SAMPLE_RATE=0.1

# =============================================================================
# CORS CONFIGURATION
# =============================================================================

# CORS settings (comma-separated values)
CORS_ORIGINS=*
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=*
CORS_ALLOW_HEADERS=*

# =============================================================================
# DEVELOPMENT CONFIGURATION
# =============================================================================

# Development-specific settings (only used when ENV=development)
DEV_MOCK_EXTERNAL_SERVICES=true
DEV_SKIP_AUTH=false
DEV_AUTO_RELOAD=true

# =============================================================================
# PRODUCTION CONFIGURATION
# =============================================================================

# Production-specific settings (only used when ENV=production)
PROD_ENABLE_COMPRESSION=true
PROD_TRUST_PROXY_HEADERS=true
PROD_MAX_REQUEST_SIZE=10485760

# =============================================================================
# MONITORING AND HEALTH CHECKS
# =============================================================================

# Health check configuration
HEALTH_CHECK_TIMEOUT=30
HEALTH_CHECK_DATABASE=true
HEALTH_CHECK_REDIS=true
HEALTH_CHECK_CELERY=true

# =============================================================================
# EXTERNAL SERVICES (Optional)
# =============================================================================

# SMS Provider (e.g., Twilio)
SMS_PROVIDER=mock
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_FROM_NUMBER=

# Push Notification Provider (e.g., Firebase)
FIREBASE_SERVER_KEY=
FIREBASE_PROJECT_ID=

# External Webhook Endpoints
EXTERNAL_WEBHOOK_URL=
EXTERNAL_WEBHOOK_SECRET=

# =============================================================================
# TESTING CONFIGURATION
# =============================================================================

# Test database (used when ENV=test)
TEST_DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/pyairtable_automation_test
TEST_REDIS_URL=redis://localhost:6379/15

# =============================================================================
# DEPLOYMENT CONFIGURATION
# =============================================================================

# Container configuration
CONTAINER_PORT=8090
CONTAINER_WORKERS=4
CONTAINER_MEMORY_LIMIT=512M
CONTAINER_CPU_LIMIT=0.5

# Kubernetes configuration
K8S_NAMESPACE=pyairtable
K8S_SERVICE_ACCOUNT=automation-domain
K8S_REPLICAS=2
K8S_RESOURCE_REQUESTS_CPU=100m
K8S_RESOURCE_REQUESTS_MEMORY=256Mi
K8S_RESOURCE_LIMITS_CPU=500m
K8S_RESOURCE_LIMITS_MEMORY=512Mi